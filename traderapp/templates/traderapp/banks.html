{% extends 'base.html' %}

{% block title %}Кошельки - Treagle{% endblock %}

{% block content %}
<div class="container">
  <h2>Управление кошельками</h2>

  <!-- Поиск -->
  <input type="text" id="wallet-filter" class="form-control mb-3" placeholder="Поиск по номеру карты/телефона или описанию...">

  <!-- Кнопка добавления -->
  <button class="btn btn-primary mb-3" onclick="openAddWalletModal()">Добавить кошелек</button>

  <!-- Таблица -->
  <table class="table table-striped">
    <thead>
      <tr>
        <th>Активен</th>
        <th>Карта / Телефон</th>
        <th>Описание</th>
        <th>Лимит сделок</th>
        <th>Лимит по сумме</th>
        <th>Оборот</th>
        <th>Дата добавления</th>
        <th>Действия</th>
      </tr>
    </thead>
    <tbody id="wallet-table">
      <!-- Здесь будет заполняться динамический контент -->
    </tbody>
  </table>
</div>

<!-- Модальное окно для добавления/редактирования кошелька -->
<div id="walletModal" class="modal fade" tabindex="-1">
  <div class="modal-dialog">
    <div class="modal-content">
      <div class="modal-header">
        <h5 class="modal-title">Добавление/Редактирование кошелька</h5>
        <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
      </div>
      <form id="wallet-form">
        <div class="modal-body">
          <div class="mb-3">
            <label for="card_number" class="form-label">Номер карты</label>
            <input type="text" class="form-control" id="card_number" required>
          </div>
          <div class="mb-3">
            <label for="phone_number" class="form-label">Номер телефона</label>
            <input type="text" class="form-control" id="phone_number">
          </div>
          <div class="mb-3">
            <label for="account_number" class="form-label">Номер счета</label>
            <input type="text" class="form-control" id="account_number">
          </div>
          <div class="mb-3">
            <label for="owner_name" class="form-label">ФИО владельца</label>
            <input type="text" class="form-control" id="owner_name" required>
          </div>
          <div class="mb-3">
            <label for="description" class="form-label">Описание</label>
            <textarea class="form-control" id="description"></textarea>
          </div>
          <div class="mb-3">
            <label for="limit_transactions_per_day" class="form-label">Лимит заявок в сутки</label>
            <input type="number" class="form-control" id="limit_transactions_per_day">
          </div>
          <div class="mb-3">
            <label for="limit_amount_per_day" class="form-label">Лимит по сумме в сутки</label>
            <input type="number" class="form-control" id="limit_amount_per_day">
          </div>
          <div class="form-check mb-3">
            <input class="form-check-input" type="checkbox" id="auto_disable_on_limit">
            <label class="form-check-label" for="auto_disable_on_limit">Автоотключение при лимите</label>
          </div>
          <div class="form-check mb-3">
            <input class="form-check-input" type="checkbox" id="notify_on_disable" disabled>
            <label class="form-check-label" for="notify_on_disable">Уведомление об отключении</label>
          </div>
        </div>
        <div class="modal-footer">
          <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Закрыть</button>
          <button type="submit" class="btn btn-primary">Сохранить</button>
        </div>
      </form>
    </div>
  </div>
</div>

<script>
  // Пример функции открытия модального окна
  function openAddWalletModal() {
    const modal = new bootstrap.Modal(document.getElementById('walletModal'));
    modal.show();
  }

  // Пример внедрения поиска
  document.getElementById("wallet-filter").addEventListener("input", function () {
    const filter = this.value.toLowerCase();
    const rows = document.querySelectorAll("#wallet-table tr");
    rows.forEach(row => {
      if (row.innerText.toLowerCase().includes(filter)) {
        row.style.display = "";
      } else {
        row.style.display = "none";
      }
    });
  });
</script>
{% endblock %}
